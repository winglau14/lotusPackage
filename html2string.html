<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="renderer" content="webkit" />
    <meta name="description" content="HTML代码转换为JavaScript字符串">
    <title>HTML代码转换为JavaScript字符串</title>
</head>
<style>
    * {
        margin: 0;
        padding: 0;
    }

    input {
        line-height: 34px;
        height: 34px;
        border: 1px solid #ddd;
        padding-left: 10px;
        width: 200px;
        outline: none;
    }

    p {
        padding-top: 14px;
    }

    button {
        cursor: pointer;
        width: 80px;
        height: 30px;
        outline: none;
    }

    textarea {
        text-align: left;
        font-size: 14px;
        line-height: 16px;
        padding: 4px;
        outline: none;
        resize: none;
    }
</style>
<body>
<div style="width:950px;margin-left:auto;margin-right:auto;margin-top:60px;">
    <h3 style="text-align: center;">HTML代码转换为JavaScript字符串</h3>
    <p style="padding-bottom:10px;">贴入要转换的HTML代码，支持过滤HTML代码中注释代码：</p>
    <textarea onmouseover="this.focus();this.select();" style="width:100%;height: 160px;margin-left: auto;margin-right: auto;vertical-align:middle;display:block;" name="" id="init-data" cols="30" rows="10">&lt;!--注释说明--&gt;
&lt;p class="p1"&gt;请在输入框内贴入你需要转换的HTML代码&lt;/p&gt;
&lt;p class='p2'&gt;HTML转换工具，可以将HTML代码转换为JavaScript字符串&lt;/p&gt;
&lt;p&gt;直接将你所要用程序输出的大串HTML代码贴到输入框中，即可一键生成&lt;/p&gt;
&lt;p&gt;如果您觉得好用，别忘了推荐给朋友！&lt;/p&gt;
&lt;!--注释说明END--&gt;</textarea>
    <p><input id="str-type" placeholder="请输入要拼接字符串类型str" value="" type="text"></p>
    <p>
        <button style="background:#33a9fa;color:#fff;border:0;margin-right:30px;" id="btn">单引号转换</button>
        <button style="background:#33a9fa;color:#fff;border:0;" id="btn2">双引号转换</button>
    </p>
    <p style="padding:10px 0;">转换结果：</p>
    <textarea onmouseover="this.focus();this.select();" style="width:100%;height: 160px;margin-left: auto;margin-right: auto;vertical-align:middle;display:block;" name="" id="change-data" cols="30" rows="10"></textarea>
</div>
</body>
<script>
    var btn = document.querySelector('#btn');
    var btn2 = document.querySelector('#btn2');
    btn.onclick = function () {
        changeFn("'");
    };
    btn2.onclick = function () {
        changeFn("\"");
    };
    function changeFn(strType2) {
        var initData = document.querySelector('#init-data').value;
        var strType = document.querySelector('#str-type').value ? document.querySelector('#str-type').value : 'str';
        if (!initData.replace(/^\s{1,}$/g, '')) {
            alert('请贴入要转换的HTML代码，嗷呜！！！');
            return false;
        }
        //html注释代码正则匹配
        var reg1 = /<!-*.{1,}->\n?/g;
        var tempArr = [];
        var tempArr2 = initData.replace(reg1, '').split('\n');
        //过滤掉空字符
        for (var i = 0; i <= tempArr2.length - 1; i++) {
            if (tempArr2[i].replace(/\s{1,}\s/g, '')) {
                tempArr.push(tempArr2[i]);
            }
        }

        console.log(tempArr);

        var str = '\n';
        for (var i = 0; i <= tempArr.length - 1; i++) {
            //单引号双引号转义
            if (tempArr[i].indexOf(strType2)) {
                //双引号转义
                if (strType2 === '"') {
                    tempArr[i] = tempArr[i].replace(/\"/g, '\\' + strType2);
                }
                //单引号转义
                if (strType2 === '\'') {
                    tempArr[i] = tempArr[i].replace(/\'/g, '\\' + strType2);
                }

            }
            if (i === 0) {
                if (i != tempArr.length - 1) {
                    str += strType + '+=' + strType2 + tempArr[i] + strType2 + '+' + '\n';
                } else {
                    str += strType + '+=' + strType2 + tempArr[i] + strType2;
                }

            } else {
                if (i != tempArr.length - 1) {
                    str += strType2 + tempArr[i] + strType2 + '+' + '\n';
                } else {
                    str += strType2 + tempArr[i] + strType2;
                }
            }
        }
        console.log(str);
        str += ';';
        document.querySelector('#change-data').value = 'var ' + strType + '="";' + str.replace(/\s{1,}\s/g, '');
    }

</script>
</html>